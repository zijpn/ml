function changeLr(){lr=+d3.select("#lr").node().value}function changeTheta0(){theta0=+d3.select("#theta0").node().value}function changeTheta1(){theta1=+d3.select("#theta1").node().value}function getCoord(e){return e.map(function(e){return{x:e,y:theta1*e+theta0}})}function updateGraph(){var e=600,t=600,a=d3.scale.linear().domain(d3.extent(data,function(e){return e.values.x})).range([0,e]).nice(),r=d3.scale.linear().domain(d3.extent(data,function(e){return e.values.y})).range([t,0]).nice();svg.select("g.x.axis").empty()&&(svg.append("g").attr("class","x axis").attr("transform","translate(0,"+t+")"),svg.append("g").attr("class","y axis")),svg.select("g.x.axis").call(d3.svg.axis().scale(a).orient("bottom")),svg.select("g.y.axis").call(d3.svg.axis().scale(r).orient("left"));var n=svg.selectAll("circle").data(data);n.enter().append("circle").attr("r",7).style("fill","steelblue"),n.attr("cx",function(e){return a(e.values.x)}).attr("cy",function(e){return r(e.values.y)}).on("mouseover",function(e){var t=theta1*e.values.x+theta0,n=svg.append("g").attr("class","pointer");n.append("line").attr("marker-end","url(#arrow)").style("stroke","steelblue").style("stroke-width",2).attr("x1",a(e.values.x)).attr("y1",r(e.values.y)).attr("x2",a(e.values.x)).attr("y2",r(t)),n.append("text").attr("text-anchor","middle").attr("x",a(e.values.x)).attr("y",r(e.values.y)+(t>e.values.y?25:-15)).text(""+d3.round(e.values.y-t,4))}).on("mouseout",function(){svg.select(".pointer").remove()}),n.exit().remove();var s=d3.svg.line().x(function(e){return a(e.x)}).y(function(e){return r(e.y)}),d=svg.selectAll("path.reg").data([getCoord(a.ticks(100))]);d.enter().append("path").attr("class","reg"),d.attr("d",s),d.exit().remove()}function update(e){d3.select("#values").html("Iteration = "+iteration+(converged?" (converged)":diverged?" (diverged)":"")+"<br/>\\(\\theta_0 = "+d3.round(theta0,4)+"\\)<br/>\\(\\theta_1 = "+d3.round(theta1,4)+"\\)<br/>\\(SSE = "+d3.round(e,2)+"\\)<br/>"),MathJax.Hub&&MathJax.Hub.Queue(["Typeset",MathJax.Hub,"values"]),updateGraph()}function ginit(){changeLr(),changeTheta0(),changeTheta1(),converged=!1,diverged=!1,iteration=0;var e=d3.sum(data,function(e){return Math.pow(e.values.y-(theta1*e.values.x+theta0),2)});update(e),d3.select("#step").attr("disabled",null),d3.select("#run").attr("disabled",null)}function gstep(){if(converged||diverged)return d3.select("#step").attr("disabled","true"),void d3.select("#run").attr("disabled","true");iteration++;var e=d3.sum(data,function(e){return e.values.y-(theta1*e.values.x+theta0)}),t=theta0+2*lr*e,a=d3.sum(data,function(e){return(e.values.y-(theta1*e.values.x+theta0))*e.values.x}),r=theta1+2*lr*a,n=Math.abs(t-theta0),s=Math.abs(r-theta1),d=1e-6;d>n&&d>s&&(converged=!0);var i=1e6;(n>i||s>i)&&(diverged=!0),theta0=t,theta1=r;var l=d3.sum(data,function(e){return Math.pow(e.values.y-(theta1*e.values.x+theta0),2)});update(l)}function grun(){for(;!converged&&!diverged;)gstep();gstep()}function changeDs(){var e=document.getElementById("dataset").value;"data1"===e?data=dataset1:"data2"===e&&(data=dataset2),ginit()}window.MathJax={messageStyle:"none",extensions:["tex2jax.js"],TeX:{extensions:["AMSmath.js","AMSsymbols.js"]},jax:["input/TeX","output/HTML-CSS"],tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,preview:"none"},"HTML-CSS":{availableFonts:["TeX"],linebreaks:{automatic:!0},scale:"90"}};var id=1,converged,diverged,iteration,lr,theta0,theta1,svg,data,dataset1=[{id:id++,values:{x:1,y:1}},{id:id++,values:{x:1.5,y:2}},{id:id++,values:{x:0,y:.5}},{id:id++,values:{x:10,y:9.5}},{id:id++,values:{x:8,y:10}},{id:id++,values:{x:5,y:3}}],dataset2=[{id:id++,values:{x:0,y:0}},{id:id++,values:{x:1,y:1}},{id:id++,values:{x:2,y:2}},{id:id++,values:{x:3,y:3}},{id:id++,values:{x:4,y:4}},{id:id++,values:{x:10,y:10}}];!function(){data=dataset1,svg=d3.select("#graph").append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 700 700").append("g").attr("transform","translate(35,35)"),svg.append("defs").append("marker").attr("id","arrow").attr("viewBox","0 -5 10 10").attr("refX",10).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").style("fill","steelblue").style("stroke","none").attr("d","M0,-5L10,0L0,5"),ginit()}();